facet_wrap(~ sex) +
labs(x = "Year", y = "Percent of births",
title = "Call me by your name (or another)",
subtitle = "Proportion of babies with common (top 100) names, per year",
alpha = "Name ranking",
caption = "#TidyTuesday Week 12 - 2022 | Data: Hadley Wickham | Chart: Giorgia Ditano") +
guides(fill = "none",
alpha = guide_legend(label.vjust = 0.5)) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin = unit(c(1, 3, 1.3, 3), "cm"),
plot.background = element_rect(fill = "#f7f7f7"),
plot.title = element_text(family = "work", size = 16, hjust = 0.5,
margin = unit(c(30, 0, 5, 0), "pt")),
plot.subtitle = element_text(family = "work", size = 13, hjust = 0.5,
margin = unit(c(0, 0, 25, 0), "pt")),
legend.background = element_rect(fill = "#f7f7f7"),
legend.title = element_text(family = "roboto", face = "italic", size = 10,
margin = unit(c(1, 10, 0, 0), "pt"), vjust = 0.55),
legend.text = element_text(face = "italic", hjust = 0, size = 9,
margin = unit(c(2, 0, 0, 0), "pt")),
legend.position = "bottom",
legend.box.background = element_rect(colour = "black", linetype = 2),
axis.text.x = element_text(family = "roboto", size = 10),
axis.text.y = element_text(family = "roboto", size = 10),
axis.title = element_text(family = "work", size = 12),
axis.title.x = element_text(margin = unit(c(10,0,20,0), "pt")),
axis.title.y = element_text(margin = unit(c(0,20,0,0), "pt")),
strip.background = element_rect(),
strip.text = element_text(family = "work", size = 12,
margin = unit(c(10,0,10,0), "pt"))
)
ggsave(common_plot, filename = "common_plot.png", width = 15, height = 9.375)
common_plot <- ggplot(common_names) +
geom_area(aes(x = year, y = prop_sex_year,
fill = sex, alpha = fct_rev(common_name))) +
scale_fill_manual(values = c("#1976D2", "#C2185B")) +
scale_alpha_manual(values = c(0.8, 0.4)) +
scale_y_continuous(labels = scales::percent) +
facet_wrap(~ sex) +
labs(x = "Year", y = "Percent of births",
title = "Call me by your name (or another)",
subtitle = "Proportion of babies with common (top 100) names, per year",
alpha = "Name ranking",
caption = "#TidyTuesday Week 12 - 2022 | Data: Hadley Wickham | Chart: Giorgia Ditano") +
guides(fill = "none",
alpha = guide_legend(label.vjust = 0.5)) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin = unit(c(1, 3, 1.3, 3), "cm"),
plot.background = element_rect(fill = "#f7f7f7"),
plot.title = element_text(family = "work", size = 16, hjust = 0.5,
margin = unit(c(30, 0, 5, 0), "pt")),
plot.subtitle = element_text(family = "work", size = 13, hjust = 0.5,
margin = unit(c(0, 0, 25, 0), "pt")),
plot.caption = element_text(family = "work", size = 9, hjust = 1,
margin = unit(c(0, 0, 0, 0), "pt")),
plot.caption.position = "bottomright",
legend.background = element_rect(fill = "#f7f7f7"),
legend.title = element_text(family = "roboto", face = "italic", size = 10,
margin = unit(c(1, 10, 0, 0), "pt"), vjust = 0.55),
legend.text = element_text(face = "italic", hjust = 0, size = 9,
margin = unit(c(2, 0, 0, 0), "pt")),
legend.position = "bottom",
legend.box.background = element_rect(colour = "black", linetype = 2),
axis.text.x = element_text(family = "roboto", size = 10),
axis.text.y = element_text(family = "roboto", size = 10),
axis.title = element_text(family = "work", size = 12),
axis.title.x = element_text(margin = unit(c(10,0,20,0), "pt")),
axis.title.y = element_text(margin = unit(c(0,20,0,0), "pt")),
strip.background = element_rect(),
strip.text = element_text(family = "work", size = 12,
margin = unit(c(10,0,10,0), "pt"))
)
ggsave(common_plot, filename = "common_plot.png", width = 15, height = 9.375)
common_plot <- ggplot(common_names) +
geom_area(aes(x = year, y = prop_sex_year,
fill = sex, alpha = fct_rev(common_name))) +
scale_fill_manual(values = c("#1976D2", "#C2185B")) +
scale_alpha_manual(values = c(0.8, 0.4)) +
scale_y_continuous(labels = scales::percent) +
facet_wrap(~ sex) +
labs(x = "Year", y = "Percent of births",
title = "Call me by your name (or another)",
subtitle = "Proportion of babies with common (top 100) names, per year",
alpha = "Name ranking",
caption = "#TidyTuesday Week 12 - 2022 | Data: Hadley Wickham | Chart: Giorgia Ditano") +
guides(fill = "none",
alpha = guide_legend(label.vjust = 0.5)) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin = unit(c(1, 3, 1.3, 3), "cm"),
plot.background = element_rect(fill = "#f7f7f7"),
plot.title = element_text(family = "work", size = 16, hjust = 0.5,
margin = unit(c(30, 0, 5, 0), "pt")),
plot.subtitle = element_text(family = "work", size = 13, hjust = 0.5,
margin = unit(c(0, 0, 25, 0), "pt")),
plot.caption = element_text(family = "work", size = 9, hjust = 1,
margin = unit(c(0, 0, 0, 0), "pt")),
legend.background = element_rect(fill = "#f7f7f7"),
legend.title = element_text(family = "roboto", face = "italic", size = 10,
margin = unit(c(1, 10, 0, 0), "pt"), vjust = 0.55),
legend.text = element_text(face = "italic", hjust = 0, size = 9,
margin = unit(c(2, 0, 0, 0), "pt")),
legend.position = "bottom",
legend.box.background = element_rect(colour = "black", linetype = 2),
axis.text.x = element_text(family = "roboto", size = 10),
axis.text.y = element_text(family = "roboto", size = 10),
axis.title = element_text(family = "work", size = 12),
axis.title.x = element_text(margin = unit(c(10,0,20,0), "pt")),
axis.title.y = element_text(margin = unit(c(0,20,0,0), "pt")),
strip.background = element_rect(),
strip.text = element_text(family = "work", size = 12,
margin = unit(c(10,0,10,0), "pt"))
)
ggsave(common_plot, filename = "common_plot.png", width = 15, height = 9.375)
common_plot <- ggplot(common_names) +
geom_area(aes(x = year, y = prop_sex_year,
fill = sex, alpha = fct_rev(common_name))) +
scale_fill_manual(values = c("#1976D2", "#C2185B")) +
scale_alpha_manual(values = c(0.8, 0.4)) +
scale_y_continuous(labels = scales::percent) +
facet_wrap(~ sex) +
labs(x = "Year", y = "Percent of births",
title = "Call me by your name (or another)",
subtitle = "Proportion of babies with common (top 100) names, per year",
alpha = "Name ranking",
caption = "#TidyTuesday Week 12 - 2022 | Data: Hadley Wickham | Chart: Giorgia Ditano") +
guides(fill = "none",
alpha = guide_legend(label.vjust = 0.5)) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin = unit(c(1, 3, 1.3, 3), "cm"),
plot.background = element_rect(fill = "#f7f7f7"),
plot.title = element_text(family = "work", size = 16, hjust = 0.5,
margin = unit(c(30, 0, 5, 0), "pt")),
plot.subtitle = element_text(family = "work", size = 13, hjust = 0.5,
margin = unit(c(0, 0, 25, 0), "pt")),
plot.caption = element_text(family = "work", size = 9, hjust = 1,
margin = unit(c(2, 0, 0, 0), "pt")),
legend.background = element_rect(fill = "#f7f7f7"),
legend.title = element_text(family = "roboto", face = "italic", size = 10,
margin = unit(c(1, 10, 0, 0), "pt"), vjust = 0.55),
legend.text = element_text(face = "italic", hjust = 0, size = 9,
margin = unit(c(2, 0, 0, 0), "pt")),
legend.position = "bottom",
legend.box.background = element_rect(colour = "black", linetype = 2),
axis.text.x = element_text(family = "roboto", size = 10),
axis.text.y = element_text(family = "roboto", size = 10),
axis.title = element_text(family = "work", size = 12),
axis.title.x = element_text(margin = unit(c(10,0,20,0), "pt")),
axis.title.y = element_text(margin = unit(c(0,20,0,0), "pt")),
strip.background = element_rect(),
strip.text = element_text(family = "work", size = 12,
margin = unit(c(10,0,10,0), "pt"))
)
ggsave(common_plot, filename = "common_plot.png", width = 15, height = 9.375)
common_plot <- ggplot(common_names) +
geom_area(aes(x = year, y = prop_sex_year,
fill = sex, alpha = fct_rev(common_name))) +
scale_fill_manual(values = c("#1976D2", "#C2185B")) +
scale_alpha_manual(values = c(0.8, 0.4)) +
scale_y_continuous(labels = scales::percent) +
facet_wrap(~ sex) +
labs(x = "Year", y = "Percent of births",
title = "Call me by your name (or another)",
subtitle = "Proportion of babies with common (top 100) names, per year",
alpha = "Name ranking",
caption = "#TidyTuesday Week 12 - 2022 | Data: Hadley Wickham | Chart: Giorgia Ditano") +
guides(fill = "none",
alpha = guide_legend(label.vjust = 0.5)) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin = unit(c(1, 3, 1.3, 3), "cm"),
plot.background = element_rect(fill = "#f7f7f7"),
plot.title = element_text(family = "work", size = 16, hjust = 0.5,
margin = unit(c(30, 0, 5, 0), "pt")),
plot.subtitle = element_text(family = "work", size = 13, hjust = 0.5,
margin = unit(c(0, 0, 25, 0), "pt")),
plot.caption = element_text(family = "work", size = 9, hjust = 1,
margin = unit(c(2, 0, 0, 0), "pt")),
legend.background = element_rect(fill = "#f7f7f7"),
legend.title = element_text(family = "roboto", face = "italic", size = 10,
margin = unit(c(1, 10, 0, 0), "pt"), vjust = 0.55),
legend.text = element_text(face = "italic", hjust = 0, size = 9,
margin = unit(c(2, 0, 2, 0), "pt")),
legend.position = "bottom",
legend.box.background = element_rect(colour = "black", linetype = 2),
axis.text.x = element_text(family = "roboto", size = 10),
axis.text.y = element_text(family = "roboto", size = 10),
axis.title = element_text(family = "work", size = 12),
axis.title.x = element_text(margin = unit(c(10,0,20,0), "pt")),
axis.title.y = element_text(margin = unit(c(0,20,0,0), "pt")),
strip.background = element_rect(),
strip.text = element_text(family = "work", size = 12,
margin = unit(c(10,0,10,0), "pt"))
)
ggsave(common_plot, filename = "common_plot.png", width = 15, height = 9.375)
common_plot <- ggplot(common_names) +
geom_area(aes(x = year, y = prop_sex_year,
fill = sex, alpha = fct_rev(common_name))) +
scale_fill_manual(values = c("#1976D2", "#C2185B")) +
scale_alpha_manual(values = c(0.8, 0.4)) +
scale_y_continuous(labels = scales::percent) +
facet_wrap(~ sex) +
labs(x = "Year", y = "Percent of births",
title = "Call me by your name (or another)",
subtitle = "Proportion of babies with common (top 100) names, per year",
alpha = "Name ranking",
caption = "#TidyTuesday Week 12 - 2022 | Data: Hadley Wickham | Chart: Giorgia Ditano") +
guides(fill = "none",
alpha = guide_legend(label.vjust = 0.5)) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin = unit(c(1, 3, 1.3, 3), "cm"),
plot.background = element_rect(fill = "#f7f7f7"),
plot.title = element_text(family = "work", size = 16, hjust = 0.5,
margin = unit(c(30, 0, 5, 0), "pt")),
plot.subtitle = element_text(family = "work", size = 13, hjust = 0.5,
margin = unit(c(0, 0, 25, 0), "pt")),
plot.caption = element_text(family = "work", size = 9, hjust = 1,
margin = unit(c(10, 0, 0, 0), "pt")),
legend.background = element_rect(fill = "#f7f7f7"),
legend.title = element_text(family = "roboto", face = "italic", size = 10,
margin = unit(c(1, 10, 0, 0), "pt"), vjust = 0.55),
legend.text = element_text(face = "italic", hjust = 0, size = 9,
margin = unit(c(2, 0, 2, 0), "pt")),
legend.position = "bottom",
legend.box.background = element_rect(colour = "black", linetype = 2),
axis.text.x = element_text(family = "roboto", size = 10),
axis.text.y = element_text(family = "roboto", size = 10),
axis.title = element_text(family = "work", size = 12),
axis.title.x = element_text(margin = unit(c(10,0,20,0), "pt")),
axis.title.y = element_text(margin = unit(c(0,20,0,0), "pt")),
strip.background = element_rect(),
strip.text = element_text(family = "work", size = 12,
margin = unit(c(10,0,10,0), "pt"))
)
ggsave(common_plot, filename = "common_plot.png", width = 15, height = 9.375)
common_plot <- ggplot(common_names) +
geom_area(aes(x = year, y = prop_sex_year,
fill = sex, alpha = fct_rev(common_name))) +
scale_fill_manual(values = c("#1976D2", "#C2185B")) +
scale_alpha_manual(values = c(0.8, 0.4)) +
scale_y_continuous(labels = scales::percent) +
facet_wrap(~ sex) +
labs(x = "Year", y = "Percent of births",
title = "Call me by your name (or another)",
subtitle = "Proportion of babies with common (top 100) names, per year",
alpha = "Name ranking",
caption = "#TidyTuesday Week 12 - 2022 | Data: Hadley Wickham | Chart: Giorgia Ditano") +
guides(fill = "none",
alpha = guide_legend(label.vjust = 0.5)) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin = unit(c(1, 3, 1.3, 3), "cm"),
plot.background = element_rect(fill = "#f7f7f7"),
plot.title = element_text(family = "work", size = 16, hjust = 0.5,
margin = unit(c(30, 0, 5, 0), "pt")),
plot.subtitle = element_text(family = "work", size = 13, hjust = 0.5,
margin = unit(c(0, 0, 25, 0), "pt")),
plot.caption = element_text(family = "work", size = 9, hjust = 1,
margin = unit(c(25, 0, 0, 0), "pt")),
legend.background = element_rect(fill = "#f7f7f7"),
legend.title = element_text(family = "roboto", face = "italic", size = 10,
margin = unit(c(1, 10, 0, 0), "pt"), vjust = 0.55),
legend.text = element_text(face = "italic", hjust = 0, size = 9,
margin = unit(c(2, 0, 2, 0), "pt")),
legend.position = "bottom",
legend.box.background = element_rect(colour = "black", linetype = 2),
axis.text.x = element_text(family = "roboto", size = 10),
axis.text.y = element_text(family = "roboto", size = 10),
axis.title = element_text(family = "work", size = 12),
axis.title.x = element_text(margin = unit(c(10,0,20,0), "pt")),
axis.title.y = element_text(margin = unit(c(0,20,0,0), "pt")),
strip.background = element_rect(),
strip.text = element_text(family = "work", size = 12,
margin = unit(c(10,0,10,0), "pt"))
)
common_plot <- ggplot(common_names) +
geom_area(aes(x = year, y = prop_sex_year,
fill = sex, alpha = fct_rev(common_name))) +
scale_fill_manual(values = c("#1976D2", "#C2185B")) +
scale_alpha_manual(values = c(0.8, 0.4)) +
scale_y_continuous(labels = scales::percent) +
facet_wrap(~ sex) +
labs(x = "Year", y = "Percent of births",
title = "Call me by your name (or another)",
subtitle = "Proportion of babies with common (top 100) names, per year",
alpha = "Name ranking",
caption = "#TidyTuesday Week 12 - 2022 | Data: Hadley Wickham | Chart: Giorgia Ditano") +
guides(fill = "none",
alpha = guide_legend(label.vjust = 0.5)) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin = unit(c(1, 3, 1.3, 3), "cm"),
plot.background = element_rect(fill = "#f7f7f7"),
plot.title = element_text(family = "work", size = 16, hjust = 0.5,
margin = unit(c(30, 0, 5, 0), "pt")),
plot.subtitle = element_text(family = "work", size = 13, hjust = 0.5,
margin = unit(c(0, 0, 25, 0), "pt")),
plot.caption = element_text(family = "work", size = 8, hjust = 1,
margin = unit(c(25, 0, 0, 0), "pt")),
legend.background = element_rect(fill = "#f7f7f7"),
legend.title = element_text(family = "roboto", face = "italic", size = 10,
margin = unit(c(1, 10, 0, 0), "pt"), vjust = 0.55),
legend.text = element_text(face = "italic", hjust = 0, size = 9,
margin = unit(c(2, 0, 2, 0), "pt")),
legend.position = "bottom",
legend.box.background = element_rect(colour = "black", linetype = 2),
axis.text.x = element_text(family = "roboto", size = 10),
axis.text.y = element_text(family = "roboto", size = 10),
axis.title = element_text(family = "work", size = 12),
axis.title.x = element_text(margin = unit(c(10,0,20,0), "pt")),
axis.title.y = element_text(margin = unit(c(0,20,0,0), "pt")),
strip.background = element_rect(),
strip.text = element_text(family = "work", size = 12,
margin = unit(c(10,0,10,0), "pt"))
)
ggsave(common_plot, filename = "common_plot.png", width = 15, height = 9.375)
common_plot <- ggplot(common_names) +
geom_area(aes(x = year, y = prop_sex_year,
fill = sex, alpha = fct_rev(common_name))) +
scale_fill_manual(values = c("#1976D2", "#C2185B")) +
scale_alpha_manual(values = c(0.8, 0.4)) +
scale_y_continuous(labels = scales::percent) +
facet_wrap(~ sex) +
labs(x = "Year", y = "Percent of births",
title = "Call me by your name (or another)",
subtitle = "Proportion of babies with common (top 100) names, per year",
alpha = "Name ranking",
caption = "#TidyTuesday Week 12 - 2022 | Data: Hadley Wickham | Chart: Giorgia Ditano") +
guides(fill = "none",
alpha = guide_legend(label.vjust = 0.5)) +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin = unit(c(1, 3, 1.3, 3), "cm"),
plot.background = element_rect(fill = "#f7f7f7"),
plot.title = element_text(family = "work", size = 16, hjust = 0.5,
margin = unit(c(30, 0, 5, 0), "pt")),
plot.subtitle = element_text(family = "work", size = 13, hjust = 0.5,
margin = unit(c(0, 0, 25, 0), "pt")),
plot.caption = element_text(family = "work", size = 8, hjust = 1,
margin = unit(c(20, 0, 0, 0), "pt")),
legend.background = element_rect(fill = "#f7f7f7"),
legend.title = element_text(family = "roboto", face = "italic", size = 10,
margin = unit(c(1, 10, 0, 0), "pt"), vjust = 0.55),
legend.text = element_text(face = "italic", hjust = 0, size = 9,
margin = unit(c(2, 0, 2, 0), "pt")),
legend.position = "bottom",
legend.box.background = element_rect(colour = "black", linetype = 2),
axis.text.x = element_text(family = "roboto", size = 10),
axis.text.y = element_text(family = "roboto", size = 10),
axis.title = element_text(family = "work", size = 12),
axis.title.x = element_text(margin = unit(c(10,0,20,0), "pt")),
axis.title.y = element_text(margin = unit(c(0,20,0,0), "pt")),
strip.background = element_rect(),
strip.text = element_text(family = "work", size = 12,
margin = unit(c(10,0,10,0), "pt"))
)
ggsave(common_plot, filename = "common_plot.png", width = 15, height = 9.375)
male_static_plot <- ggplot(babynames_top15 %>% filter(sex == "Male"),
aes(x = fct_rev(fct_inseq(name)), y = year, fill = prop_sex_year)) +
geom_tile(alpha = 0.95, width = .5, height = 1) +
scale_y_continuous(breaks = yticks_year, labels = ytext_year) +
scale_fill_material(palette = "blue", labels = scales::percent) +
labs(title = "What's his name?",
subtitle = "Most popular male baby names in the US over time",
x = "Name", y = "Year",
fill = "Percent of male\nbirths (per year)",
caption = "#TidyTuesday Week 12 - 2022 | Data: Hadley Wickham | Chart: Giorgia Ditano") +
coord_flip(clip = 'off') +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_line(size = 0.2),
panel.background = element_blank(),
panel.ontop = T,
plot.margin = unit(c(1, 8, 1, 8), "cm"),
plot.background = element_rect(fill = "#f7f7f7"),
plot.title = element_text(family = "work", size = 16, hjust = 0.5,
margin = unit(c(25, 0, 5, 0), "pt")),
plot.subtitle = element_text(family = "work", size = 13, hjust = 0.5,
margin = unit(c(0, 0, 15, 0), "pt")),
plot.caption = element_text(family = "work", size = 8, hjust = 1,
margin = unit(c(20, 0, 0, 0), "pt")),
legend.background = element_rect(fill = "#f7f7f7"),
legend.title = element_text(family = "roboto", face = "italic", size = 9,
margin = unit(c(1, 0, 4, 0), "pt")),
legend.text = element_text(face = "italic", hjust = 1),
legend.box.background = element_rect(colour = "black", linetype = 2),
axis.text.x = element_text(family = "roboto"),
axis.text.y = element_text(family = "work", size = 11, face = "italic",
color = "black", hjust = 0.5),
axis.title = element_text(family = "work", size = 12),
axis.title.x = element_text(margin = unit(c(10,0,20,0), "pt")),
axis.title.y = element_text(margin = unit(c(0,25,0,10), "pt")),
axis.ticks.y = element_blank()
) +
annotation_custom(
grob = male_grob, xmin = 1, xmax = 15, ymin = 1860, ymax = 1860)
# get the top 15 names per sex, over all times
names_top15 <- babynames %>%
group_by(sex, name) %>%
summarise(total_n = sum(n)) %>%
top_n(15, total_n) %>%
select(-total_n)
babynames_top15 <- babynames %>%
# new column: percent of specific sex total birth [per year, per name]
group_by(year, sex) %>%
mutate(total_sex_year = sum(n),) %>%
ungroup() %>%
mutate(prop_sex_year = n / total_sex_year) %>%
select(-total_sex_year) %>%
# filtering for the top 15 names
right_join(names_top15, by = c("sex","name"))
rm(names_top15)
yticks_year <- babynames_top15$year[babynames_top15$year %% 10 == 0] %>% unique()
ytext_year <-  as.character(babynames_top15$year[babynames_top15$year %% 10 == 0] %>% unique())
names_pal <- c(brewer.pal(12, "Set3"), brewer.pal(3, "Set2"))
female_grob <- rectGrob(x = 0, y = seq(0, 1, length.out = 15), width = unit(2.1, "cm"), height = unit(0.6, "cm"),
gp = gpar(fill = names_pal, alpha = 0.6, lty = "dotted"))
female_static_plot <- ggplot(babynames_top15 %>% filter(sex == "Female"),
aes(x = fct_rev(fct_inseq(name)), y = year, fill = prop_sex_year)) +
geom_tile(alpha = 0.95, width = .5, height = 1) +
scale_y_continuous(breaks = yticks_year, labels = ytext_year) +
scale_fill_material(palette = "pink", labels = scales::percent) +
labs(title = "What's her name?",
subtitle = "Most popular female baby names in the US over time",
x = "Name", y = "Year",
fill = "Percent of female\nbirths (per year)",
caption = "#TidyTuesday Week 12 - 2022 | Data: Hadley Wickham | Chart: Giorgia Ditano") +
coord_flip(clip = 'off') +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_line(size = 0.2),
panel.background = element_blank(),
panel.ontop = T,
plot.margin = unit(c(1, 8, 1, 8), "cm"),
plot.background = element_rect(fill = "#f7f7f7"),
plot.title = element_text(family = "work", size = 16, hjust = 0.5,
margin = unit(c(25, 0, 5, 0), "pt")),
plot.subtitle = element_text(family = "work", size = 13, hjust = 0.5,
margin = unit(c(0, 0, 15, 0), "pt")),
plot.caption = element_text(family = "work", size = 8, hjust = 1,
margin = unit(c(20, 0, 0, 0), "pt")),
legend.background = element_rect(fill = "#f7f7f7"),
legend.title = element_text(family = "roboto", face = "italic", size = 9,
margin = unit(c(1, 0, 4, 0), "pt")),
legend.text = element_text(face = "italic", hjust = 1),
legend.box.background = element_rect(colour = "black", linetype = 2),
axis.text.x = element_text(family = "roboto"),
axis.text.y = element_text(family = "work", size = 11, face = "italic",
color = "black", hjust = 0.5),
axis.title = element_text(family = "work", size = 12),
axis.title.x = element_text(margin = unit(c(10,0,20,0), "pt")),
axis.title.y = element_text(margin = unit(c(0,25,0,10), "pt")),
axis.ticks.y = element_blank()
) +
annotation_custom(
grob = female_grob, xmin = 1, xmax = 15, ymin = 1862.2, ymax = 1862.2)
ggsave(female_static_plot, filename = "female_st_plot.png", width = 15, height = 9.375)
male_grob <- rectGrob(x = 0, y = seq(0, 1, length.out = 15), width = unit(2.4, "cm"), height = unit(0.6, "cm"),
gp = gpar(fill = names_pal, alpha = 0.6, lty = "dotted"))
male_static_plot <- ggplot(babynames_top15 %>% filter(sex == "Male"),
aes(x = fct_rev(fct_inseq(name)), y = year, fill = prop_sex_year)) +
geom_tile(alpha = 0.95, width = .5, height = 1) +
scale_y_continuous(breaks = yticks_year, labels = ytext_year) +
scale_fill_material(palette = "blue", labels = scales::percent) +
labs(title = "What's his name?",
subtitle = "Most popular male baby names in the US over time",
x = "Name", y = "Year",
fill = "Percent of male\nbirths (per year)",
caption = "#TidyTuesday Week 12 - 2022 | Data: Hadley Wickham | Chart: Giorgia Ditano") +
coord_flip(clip = 'off') +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_line(size = 0.2),
panel.background = element_blank(),
panel.ontop = T,
plot.margin = unit(c(1, 8, 1, 8), "cm"),
plot.background = element_rect(fill = "#f7f7f7"),
plot.title = element_text(family = "work", size = 16, hjust = 0.5,
margin = unit(c(25, 0, 5, 0), "pt")),
plot.subtitle = element_text(family = "work", size = 13, hjust = 0.5,
margin = unit(c(0, 0, 15, 0), "pt")),
plot.caption = element_text(family = "work", size = 8, hjust = 1,
margin = unit(c(20, 0, 0, 0), "pt")),
legend.background = element_rect(fill = "#f7f7f7"),
legend.title = element_text(family = "roboto", face = "italic", size = 9,
margin = unit(c(1, 0, 4, 0), "pt")),
legend.text = element_text(face = "italic", hjust = 1),
legend.box.background = element_rect(colour = "black", linetype = 2),
axis.text.x = element_text(family = "roboto"),
axis.text.y = element_text(family = "work", size = 11, face = "italic",
color = "black", hjust = 0.5),
axis.title = element_text(family = "work", size = 12),
axis.title.x = element_text(margin = unit(c(10,0,20,0), "pt")),
axis.title.y = element_text(margin = unit(c(0,25,0,10), "pt")),
axis.ticks.y = element_blank()
) +
annotation_custom(
grob = male_grob, xmin = 1, xmax = 15, ymin = 1860, ymax = 1860)
ggsave(male_static_plot, filename = "male_st_plot.png", width = 15, height = 9.375)
